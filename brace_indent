#!/usr/bin/env python3
"""brace-indent - Run the TAS brace-indenter using Node.js"""
"""use open and closed braces instead of unicode symbol"""

import os
import sys
import subprocess
from pathlib import Path


def main():
    pbp = os.environ.get("PBP")
    if not pbp:
        print("Error: PBP environment variable not set", file=sys.stderr)
        sys.exit(1)
    
    indenter_script = Path(pbp) / "tas" / "brace_indenter.mjs"
    
    if not indenter_script.exists():
        print(f"Error: Script not found: {indenter_script}", file=sys.stderr)
        sys.exit(1)
    
    try:
        # Pass stdin through to the Node.js script
        subprocess.run(
            ["node", str(indenter_script)],
            check=True
        )
    except subprocess.CalledProcessError as e:
        sys.exit(e.returncode)
    except FileNotFoundError:
        print("Error: 'node' command not found. Please install Node.js.", file=sys.stderr)
        sys.exit(1)


if __name__ == "__main__":
    main()
